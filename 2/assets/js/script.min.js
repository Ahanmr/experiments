var controlkit,osc1Type,osc2Type,osc3Type,data={bins:{options:[1024,512,256,128],selection:null},smoothing:0.8,c_1:{amplitude:0.3,frequency:343.53,phase:0,function:{options:["Sine","Square","Sawtooth","Triangle","None"],selection:null},frequency_domain:!1},c_2:{amplitude:0.3,frequency:345.53,phase:0,function:{options:["Sine","Square","Sawtooth","Triangle","None"],selection:null},frequency_domain:!1},c_3:{freeze:!0,operation:{options:["Add","Multiply"],selection:null},frequency_domain:!1}},createControlKit=()=>{controlkit=new ControlKit,controlkit.addPanel({align:"right",fixed:!0}).addSelect(data.bins,"options",{label:"Bins / Samples",onChange:function(a){data.bins.selection=data.bins.options[a]}}).addNumberInput(data,"smoothing",{label:"Smoothing",step:0.1}).addGroup({label:"Wave Controls"}).addSubGroup({label:"Input Wave #1"}).addSelect(data.c_1["function"],"options",{label:"Function",onChange:function(a){data.c_1["function"].selection=data.c_1["function"].options[a].toLowerCase(),osc1Type=data.c_1["function"].selection.toLowerCase()}}).addNumberInput(data.c_1,"amplitude",{label:"Amplitude",step:0.1}).addNumberInput(data.c_1,"frequency",{label:"Frequency"}).addNumberInput(data.c_1,"phase",{label:"Phase",step:10}).addCheckbox(data.c_1,"frequency_domain",{label:"Frequency Spectrum?",onChange:function(){}}).addSubGroup({label:"Input Wave #2"}).addSelect(data.c_2["function"],"options",{label:"Function",onChange:function(a){data.c_2["function"].selection=data.c_2["function"].options[a].toLowerCase(),osc2Type=data.c_2["function"].selection.toLowerCase()}}).addNumberInput(data.c_2,"amplitude",{label:"Amplitude",step:0.1}).addNumberInput(data.c_2,"frequency",{label:"Frequency"}).addNumberInput(data.c_2,"phase",{label:"Phase",step:10}).addCheckbox(data.c_2,"frequency_domain",{label:"Frequency Spectrum?",onChange:function(){}}).addSubGroup({label:"Output Wave"}).addSelect(data.c_3.operation,"options",{label:"Operation",onChange:function(a){data.c_3.operation.selection=data.c_3.operation.options[a]}}).addCheckbox(data.c_3,"frequency_domain",{label:"Frequency Spectrum?",onChange:function(){}})};data.bins.selection=1024,data.smoothing=0.8;var waveform_1,spectrum_1,c_1=a=>{let b,c=!1,d,e;a.setup=()=>{b=a.createCanvas(0.7*a.windowWidth,a.windowHeight/3),$("#canvas-1").html(b.canvas),d=new p5.Oscillator,d.freq(data.c_1.frequency),d.amp(data.c_1.amplitude),e=new p5.FFT(data.smoothing,data.bins.selection),e.setInput(d)};let f=0;a.draw=()=>{if(a.background(0),a.strokeCap(a.SQUARE),a.strokeWeight(1),a.stroke(255),a.line(0*a.width,0.5*a.height,1*a.width,0.5*a.height),null!==data.c_1["function"].selection&&"none"!==data.c_1["function"].selection?c=!0:(c=!1,d.stop(),f=0),c&&(0==f&&(d.start(),f++),d.phase(a.map(data.c_1.phase,0,360,0,1)),d.amp(data.c_1.amplitude,0.05),d.freq(data.c_1.frequency),d.setType(osc1Type)),waveform_1=e.waveform(),spectrum_1=e.analyze(),a.noFill(),a.beginShape(),a.stroke("tomato"),a.strokeWeight(1),data.c_1.frequency_domain)for(var g=0;g<data.bins.selection;g++){let k=a.map(g,0,data.bins.selection,0,a.width),l=-a.height+a.map(spectrum_1[g],0,255,0.95*a.height,0.45*a.height);a.rect(k,a.height,a.width/data.bins.selection,l)}else for(var g=0;g<data.bins.selection;g++){let k=a.map(g,0,data.bins.selection,0,a.width),l=a.map(waveform_1[g],-1,1,0,a.height);a.vertex(k,l)}a.endShape()},a.windowResized=()=>{a.resizeCanvas(0.7*a.windowWidth,a.windowHeight/3)}},waveform_2,spectrum_2,c_2=a=>{let b,c=!1,d,e;a.setup=()=>{b=a.createCanvas(0.7*a.windowWidth,a.windowHeight/3),$("#canvas-2").html(b.canvas),d=new p5.Oscillator,d.freq(data.c_2.frequency),d.amp(data.c_2.amplitude),e=new p5.FFT(data.smoothing,data.bins.selection),e.setInput(d)};let f=0;a.draw=()=>{if(a.background(0),a.strokeCap(a.SQUARE),a.strokeWeight(1),a.stroke(255),a.line(0*a.width,0.5*a.height,1*a.width,0.5*a.height),null!==data.c_2["function"].selection&&"none"!==data.c_2["function"].selection?c=!0:(c=!1,d.stop(),f=0),c&&(0==f&&(d.start(),f++),d.amp(data.c_2.amplitude,0.05),d.freq(data.c_2.frequency),d.phase(a.map(data.c_2.phase,0,360,0,1)),d.setType(osc2Type)),waveform_2=e.waveform(),spectrum_2=e.analyze(),a.noFill(),a.beginShape(),a.stroke("#FF2F00"),a.strokeWeight(1),data.c_2.frequency_domain)for(var g=0;g<data.bins.selection;g++){let k=a.map(g,0,data.bins.selection,0,a.width),l=-a.height+a.map(spectrum_2[g],0,255,0.95*a.height,0.45*a.height);a.rect(k,a.height,a.width/data.bins.selection,l)}else for(var g=0;g<data.bins.selection;g++){let k=a.map(g,0,data.bins.selection,0,a.width),l=a.map(waveform_2[g],-1,1,0,a.height);a.vertex(k,l)}a.endShape()},a.windowResized=()=>{a.resizeCanvas(0.7*a.windowWidth,a.windowHeight/3)}},c_3=a=>{let b,c,d,e;a.setup=()=>{b=a.createCanvas(0.7*a.windowWidth,a.windowHeight/3),$("#canvas-3").html(b.canvas),c=new p5.FFT(data.smoothing,data.bins.selection)},a.draw=()=>{switch(a.background(0),a.strokeCap(a.SQUARE),a.strokeWeight(1),a.stroke(255),a.line(0*a.width,0.5*a.height,1*a.width,0.5*a.height),data.c_3.operation.selection){case"Multiply":if(1024>data.bins.selection)for(var f=0,g=2*data.bins.selection;f<g;f+=1)e[f]=0;for(var f=0,g=data.bins.selection;f<g;f+=1)if(d[f]=1.5*waveform_1[f]*(1.5*waveform_2[f]),1024>data.bins.selection)for(var k=0,g=2*data.bins.selection;k<g;k+=1)f>=k&&(e[f+k]+=a.map(spectrum_1[f]*spectrum_2[k]/2,0,65025/2,0,255),e[f-k]+=a.map(spectrum_1[f]*spectrum_2[k]/2,0,65025/2,0,255));break;case"Add":default:d=c.waveform(),e=c.analyze();}if(a.noFill(),a.beginShape(),a.stroke(0,255,0),a.strokeWeight(1),data.c_3.frequency_domain){for(var f=0;f<data.bins.selection;f++)if("Multiply"==data.c_3.operation.selection){let l=a.map(f,0,data.bins.selection,0,a.width),m=-a.height+a.map(e[f],0,255,0.95*a.height,0.45*a.height);a.rect(l,a.height,a.width/data.bins.selection,m)}else{let l=a.map(f,0,data.bins.selection,0,a.width),m=-a.height+a.map(e[f],0,255,0.95*a.height,0.45*a.height);a.rect(l,a.height,a.width/data.bins.selection,m)}}else for(var f=0;f<data.bins.selection;f++){let l=a.map(f,0,data.bins.selection,0,a.width),m=a.map(1.5*d[f],-1,1,0,a.height);a.vertex(l,m)}a.endShape()},a.windowResized=()=>{a.resizeCanvas(0.7*a.windowWidth,a.windowHeight/3)}};createControlKit();var canvas_1=new p5(c_1),canvas_2=new p5(c_2),canvas_3=new p5(c_3);