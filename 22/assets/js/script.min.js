let data={sketch:{background:"#000000",gravity:null},fireworks:{n:10,explosion_n:150,color_mode:255}};class Particle{constructor(a,b,c="#FFFFFF",d=!1){this.pos=createVector(a,b),this.accn=createVector(0,0),this.exploded=d,this.exploded?(this.vel=p5.Vector.random2D(),this.vel.mult(random(1,6))):this.vel=createVector(0,-random(12,17)),this.color=c,this.lifespan=255}applyForce(a){this.accn.add(a)}update(){this.exploded&&(this.vel.mult(random(0.97,1)),0<=this.lifespan&&(this.lifespan-=2)),this.vel.add(this.accn),this.pos.add(this.vel),this.accn.mult(0)}show(){stroke(this.color,this.lifespan),this.exploded?(push(),strokeWeight(1),point(this.pos.x,this.pos.y),pop()):(push(),strokeWeight(3),point(this.pos.x,this.pos.y),pop())}done(){return!!(0>this.lifespan)}}class Firework{constructor(){this.color=color(random(255),random(255),random(255)),this.firework=new Particle(random(width),height,this.color),this.exploded=!1,this.particles=[]}update(){this.exploded||(this.firework.applyForce(data.sketch.gravity),this.firework.update(),0<=this.firework.vel.y&&(this.exploded=!0,this.explode()))}explode(){for(var a=0,b=data.fireworks.explosion_n;a<b;a+=1)this.particles.push(new Particle(this.firework.pos.x,this.firework.pos.y,this.color,this.exploded))}show(){if(!this.exploded)this.firework.show();else for(var a=0,b=data.fireworks.explosion_n;a<b;a+=1)this.particles[a]&&(this.particles[a].done()?this.particles.splice(a,1):(this.particles[a].applyForce(data.sketch.gravity),this.particles[a].update(),this.particles[a].show()))}}let fireworks=[];function setup(){createCanvas(windowWidth,windowHeight),data.sketch.gravity=createVector(0,0.2),background(0)}function draw(){background(0,150),0.1>random(1)&&fireworks.push(new Firework);for(var a=0,b=fireworks.length;a<b;a+=1)fireworks[a].update(),fireworks[a].show();30<fireworks.length&&fireworks.splice(0,1)}