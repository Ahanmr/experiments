let data={sketch:{background:"#000000"}},vehicles=[];function setup(){createCanvas(windowWidth,windowHeight);for(var a=0;a<100;a+=1)vehicles[a]=new Vehicle(random(width),random(height),a);colorMode(HSB,100),background(data.sketch.background),noStroke()}function draw(){background(0,20);let a=new p5.Vector(mouseX,mouseY);for(var b=0,c=vehicles.length;b<c;b+=1)vehicles[b].seek(a);vehicles.forEach(e=>{e.separate(vehicles),e.update(),e.display()})}class Vehicle{constructor(a,b,c){this.location=new p5.Vector(a,b),this.velocity=p5.Vector.random2D(),this.acceleration=new p5.Vector(0,0),this.i=c,this.r=map(c,0,25,4,4),this.maxSpeed=random(20,20),this.maxForce=2,this.desired_separation=100}applyForce(a){this.acceleration.add(a)}update(){this.velocity.add(this.acceleration),this.velocity.limit(this.maxSpeed),this.location.add(this.velocity),this.acceleration.mult(0)}seek(a){let b=p5.Vector.sub(a,this.location),c=b.mag();if(b.normalize(),100>c){let f=map(c,10,100,2,this.maxSpeed);b.mult(f)}else b.mult(this.maxSpeed);let e=p5.Vector.sub(b,this.velocity);e.limit(this.maxForce),this.applyForce(e)}separate(a){let b=new p5.Vector,c=0;if(a.forEach(e=>{let f=p5.Vector.dist(this.location,e.location);if(0<f&&f<this.desired_separation){let g=p5.Vector.sub(this.location,e.location);g.normalize(),b.add(g),c++}}),0<c){b.div(c),b.setMag(this.maxSpeed);let e=p5.Vector.sub(b,this.velocity);e.limit(this.maxForce),this.applyForce(e)}}display(){let a=this.velocity.heading()+PI/2;push(),translate(this.location.x,this.location.y),rotate(a),fill(map(this.velocity.mag(),0,20,0,100),100,100,90),triangle(this.r,this.r,-this.r,this.r,0,2*-this.r),pop()}}